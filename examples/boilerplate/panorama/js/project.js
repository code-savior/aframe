var project = {
  "bg_h5startup_option": 0,
  "bg_music_loop": true,
  "bg_music_mute": false,
  "bg_music_volume": 100,
  "bg_picture_option": 0,
  "description": "",
  "embeds": [
  ],
  "encode_param.bitrate": 10000,
  "encode_param.bitrate_mode": 0,
  "encode_param.resolution": "3840*1920",
  "encode_param.resolution_mode": 0,
  "hotspots": [
      {
          "end_time": 107.80000305175781,
          "link_icon": "click_touch",
          "opacity": 100,
          "pos_pitch": 0,
          "pos_yaw": 0,
          "source_stage": {
              "uuid": "92983d247df1494c84d86bda684b125f"
          },
          "spin_polar_pitch": 0,
          "spin_polar_roll": 0,
          "spin_polar_yaw": 0,
          "start_time": 0,
          "target_stage": {
              "uuid": "de60a58c5ce14a84a96fa18ab01be533"
          },
          "title": "photo2",
          "title_visible": true,
          "uuid": "794a521ab0694ae4b10785dec31bc770",
          "visible": true,
          "zoom_scale": 100
      },
      {
          "end_time": 130.79733276367188,
          "link_icon": "click_touch",
          "opacity": 100,
          "pos_pitch": 0,
          "pos_yaw": 0,
          "source_stage": {
              "uuid": "de60a58c5ce14a84a96fa18ab01be533"
          },
          "spin_polar_pitch": 0,
          "spin_polar_roll": 0,
          "spin_polar_yaw": 0,
          "start_time": 0,
          "target_stage": {
              "uuid": "a8b09280b35a4020b16e331b0643e328"
          },
          "title": "video1",
          "title_visible": true,
          "uuid": "59ddf0065693477ebb0608704fa113e6",
          "visible": true,
          "zoom_scale": 100
      },
      {
          "end_time": 63.06666564941406,
          "link_icon": "click_touch",
          "opacity": 100,
          "pos_pitch": 0,
          "pos_yaw": 0,
          "source_stage": {
              "uuid": "a8b09280b35a4020b16e331b0643e328"
          },
          "spin_polar_pitch": 0,
          "spin_polar_roll": 0,
          "spin_polar_yaw": 0,
          "start_time": 0,
          "target_stage": {
              "uuid": "92983d247df1494c84d86bda684b125f"
          },
          "title": "photo1",
          "title_visible": true,
          "uuid": "d3d11f4b427c49a3834e1d93a52fda05",
          "visible": true,
          "zoom_scale": 100
      }
  ],
  "mediabox": {
      "mediaboxes": [
      ],
      "medias": [
          {
              "uuid": "ebbb9e46e06b4ace9020997e83bc9e13"
          },
          {
              "uuid": "36f9dcdcee2e489f9056b18cc4e710ac"
          },
          {
              "uuid": "3034a31e47e34cdabc8f78cfdb632148"
          }
      ],
      "title": "全部"
  },
  "medias": [
      {
          "audio_bitrate": 128020,
          "audio_codec": "aac",
          "duration": 107.80000305175781,
          "file_hash": "",
          "file_size": "606899557",
          "frame_rate": 25,
          "height": 1920,
          "is_cache": false,
          "orig_filename": "20211104_江布拉提风光.mp4",
          "path": "p1.jpg",
          "projection_angle": 360,
          "title": "",
          "type": "Photo",
          "uuid": "36f9dcdcee2e489f9056b18cc4e710ac",
          "video_bitrate": 44903401,
          "video_codec": "h264",
          "vr_tag": 1,
          "width": 3840
      },
      {
          "audio_bitrate": 128705,
          "audio_codec": "aac",
          "duration": 130.79733276367188,
          "file_hash": "",
          "file_size": "701892195",
          "frame_rate": 29.970029830932617,
          "height": 1920,
          "is_cache": false,
          "orig_filename": "20211028_江布拉提花海.mp4",
          "path": "p2.jpg",
          "projection_angle": 360,
          "title": "",
          "type": "Photo",
          "uuid": "ebbb9e46e06b4ace9020997e83bc9e13",
          "video_bitrate": 42791358,
          "video_codec": "h264",
          "vr_tag": 1,
          "width": 3840
      },
      {
          "audio_bitrate": 128470,
          "audio_codec": "aac",
          "duration": 63.06666564941406,
          "file_hash": "",
          "file_size": "320692818",
          "frame_rate": 30,
          "height": 1920,
          "is_cache": false,
          "orig_filename": "sth20211024_.mp4",
          "path": "v1.mp4",
          "projection_angle": 360,
          "title": "",
          "type": "Video",
          "uuid": "3034a31e47e34cdabc8f78cfdb632148",
          "video_bitrate": 40541989,
          "video_codec": "h264",
          "vr_tag": 1,
          "width": 3840
      }
  ],
  "origin_uuid": "76da7313a4394ca19804718ceab2895d",
  "stages": [
      {
          "end_time": 107.80000305175781,
          "end_time_visible": false,
          "fov_current": 90,
          "fov_global": true,
          "fov_max": 110,
          "fov_min": 60,
          "isStart": true,
          "mask_enable": true,
          "mask_follow_rotate": true,
          "mask_zoom_scale": 100,
          "media": {
              "uuid": "36f9dcdcee2e489f9056b18cc4e710ac"
          },
          "play_action": 0,
          "play_delay_deconds": 0,
          "primary_pitch": 0,
          "primary_roll": 0,
          "primary_yaw": 0,
          "scene_pos_x": -312.6207906295755,
          "scene_pos_y": 26.705710102489,
          "start_pitch": 0,
          "start_time": 0,
          "start_time_visible": false,
          "start_yaw": 0,
          "uuid": "92983d247df1494c84d86bda684b125f",
          "view_mode": 0
      },
      {
          "end_time": 130.79733276367188,
          "end_time_visible": false,
          "fov_current": 90,
          "fov_global": true,
          "fov_max": 110,
          "fov_min": 60,
          "isStart": false,
          "mask_enable": true,
          "mask_follow_rotate": true,
          "mask_zoom_scale": 100,
          "media": {
              "uuid": "ebbb9e46e06b4ace9020997e83bc9e13"
          },
          "play_action": 0,
          "play_delay_deconds": 0,
          "primary_pitch": 0,
          "primary_roll": 0,
          "primary_yaw": 0,
          "scene_pos_x": -39.15080527086383,
          "scene_pos_y": 52.00585651537335,
          "start_pitch": 0,
          "start_time": 0,
          "start_time_visible": false,
          "start_yaw": 0,
          "uuid": "de60a58c5ce14a84a96fa18ab01be533",
          "view_mode": 0
      },
      {
          "end_time": 63.06666564941406,
          "end_time_visible": false,
          "fov_current": 90,
          "fov_global": true,
          "fov_max": 110,
          "fov_min": 60,
          "isStart": false,
          "mask_enable": true,
          "mask_follow_rotate": true,
          "mask_zoom_scale": 100,
          "media": {
              "uuid": "3034a31e47e34cdabc8f78cfdb632148"
          },
          "play_action": 0,
          "play_delay_deconds": 0,
          "primary_pitch": 0,
          "primary_roll": 0,
          "primary_yaw": 0,
          "scene_pos_x": 237.74524158125917,
          "scene_pos_y": -56.222547584187424,
          "start_pitch": 0,
          "start_time": 0,
          "start_time_visible": false,
          "start_yaw": 0,
          "uuid": "a8b09280b35a4020b16e331b0643e328",
          "view_mode": 0
      }
  ],
  "title": "x3",
  "uuid": "ed20bfe8c6c740c2bf9e94d061a79684",
  "version": "1.2"
};

function getSceneFromProject(sceneid) {
    const media = getSceneMedia(sceneid);
    const hotspots = getSceneHotspots(sceneid);

    return {
        type: media.type,
        media: media.path,
        hotspots,
    };
}

function getSceneHotspots(sceneid) {
    const hotspots = project.hotspots.filter(function(hotspot) {
        return hotspot.source_stage.uuid === sceneid && hotspot.visible === true
    });

    return hotspots.map(function(hotspot){
        return {
            icon: `assets/icon/hotspot/${hotspot.link_icon}.png`,
            title: hotspot.title,
            sceneid: hotspot.target_stage.uuid,
        }
    });
}

function getSceneMedia(sceneid) {
    const scene = project.stages.filter(function(stage) {
        return stage.uuid === sceneid
    })[0];
    const media = project.medias.filter(function(media) {
        return media.uuid === scene.media.uuid
    })[0];
    let type;
    switch (media.type) {
        case 'Photo':
            type = 'photo';
            break;
        case 'Video':
            type = 'video';
            break;
    };
    const path = `medias/${media.path}`;
    return {
        type,
        path,
    };
}

function getFirstSceneid() {
    return project.stages.filter(function(stage) {
        return stage.isStart
    })[0].uuid
}